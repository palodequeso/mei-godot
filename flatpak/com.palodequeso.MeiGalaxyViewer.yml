app-id: com.palodequeso.MeiGalaxyViewer
runtime: org.freedesktop.Platform
runtime-version: '23.08'
sdk: org.freedesktop.Sdk
command: godot-mei-viewer

finish-args:
  # Display access
  - --share=ipc
  - --socket=x11
  - --socket=wayland
  # GPU acceleration
  - --device=dri
  # For OpenGL/Vulkan
  - --env=MESA_GL_VERSION_OVERRIDE=4.5

modules:
  - name: mei-galaxy-viewer
    buildsystem: simple
    build-commands:
      - install -Dm755 godot-mei-viewer.x86_64 /app/bin/godot-mei-viewer
      - install -Dm644 godot-mei-viewer.pck /app/bin/ || true
      - install -Dm644 libmei_godot.so /app/bin/
      - install -Dm644 mei.gdextension /app/bin/
      - install -Dm644 com.palodequeso.MeiGalaxyViewer.desktop /app/share/applications/com.palodequeso.MeiGalaxyViewer.desktop
      - install -Dm644 com.palodequeso.MeiGalaxyViewer.png /app/share/icons/hicolor/256x256/apps/com.palodequeso.MeiGalaxyViewer.png
      - install -Dm644 com.palodequeso.MeiGalaxyViewer.metainfo.xml /app/share/metainfo/com.palodequeso.MeiGalaxyViewer.metainfo.xml
    sources:
      - type: file
        path: ../builds/linux/godot-mei-viewer.x86_64
      - type: file
        path: ../builds/linux/godot-mei-viewer.pck
      - type: file
        path: ../builds/linux/libmei_godot.so
      - type: file
        path: ../mei.gdextension
      - type: file
        path: com.palodequeso.MeiGalaxyViewer.desktop
      - type: file
        path: com.palodequeso.MeiGalaxyViewer.png
      - type: file
        path: com.palodequeso.MeiGalaxyViewer.metainfo.xml
